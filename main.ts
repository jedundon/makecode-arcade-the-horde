namespace SpriteKind {
    export const orb = SpriteKind.create()
}
controller.B.onEvent(ControllerButtonEvent.Pressed, function () {
    magicCreateOrb()
})
function spriteDistance (s1: Sprite, s2: Sprite) {
    return Math.sqrt((s1.x - s2.x) * (s1.x - s2.x) + (s1.y - s2.y) * (s1.y - s2.y))
}
function magicUpdateOrbPositions () {
    player_orb_angle_index = degreesToRadians(game.runtime() / 1000 * player_orb_angular_velocity % 360)
    for (let o of sprites.allOfKind(SpriteKind.orb)) {
        player_orb_angle = player_orb_angle_index + degreesToRadians(sprites.readDataNumber(o, "id") / player_orb_count * 360)
        o.setPosition(scene.screenWidth() / 2 + Math.cos(player_orb_angle) * player_orb_radius, scene.screenHeight() / 2 + (0 - Math.sin(player_orb_angle) * player_orb_radius))
    }
}
function closestEnemy () {
    enemy_closest = sprites.allOfKind(SpriteKind.Enemy)[0]
    enemy_closest_distance = 99999
    for (let e of sprites.allOfKind(SpriteKind.Enemy)) {
        enemy_distance = spriteDistance(char, e)
        if (enemy_distance < enemy_closest_distance) {
            enemy_closest = e
            enemy_closest_distance = enemy_distance
        }
    }
    return enemy_closest
}
function setupWorld () {
    scroller.setLayerImage(scroller.BackgroundLayer.Layer0, img`
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777775555577777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777755555577777777777777777555555577777777777777777777555557777777777777777777777777777777777777777555777777777777777777777777777777777777777
        7777777777777777777777777777555557777777777777777777555557777777777777777777775555777777777777777777777777777777777755775555577777777777777777777777777777777777
        7777777777777777777777777777777775557777777777777777777755555777777777777777777777555577777777777777777777777777777777777777555777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777555777777777777777777777755577777777777777777777777777777777777777557777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777775555577777777777777777777777777777557777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777555555777777777777777777777777777777555777777777777777777777777777777777777777777775555555577777777777777777777777777777777777777777777777777777777777
        7777777775577777777777777777777777777777777555777777777777777777777755557777777777777777777755777777777777777777777777777777777777777777777777777755555557777777
        7777777755777777777777777777777777777777555777777777777777777777555577777777777777777777777577777777777777777777777777755555577777777777777777755577777777777777
        7777777557777777777777777777777777777555777777777777777777777555777777777777777777777777775777777777777777777777777755577777777777777777777775577777777777777777
        7777777777777777777777777777777777755577777777777777777777775577777777777777777777777777755777777777777777777777777557777777777777777777777755777777777777777777
        7777777777777777777557777777777777557777775777777777777777755777777777777777777777777777557777777777777777777777755777777777777777777777777557777777777777777777
        7777777777777775755755777777777777577777755557777777777777757777777777755777777777777777577777777757777777777777557777777777777777777777775577777777777777777777
        7777777777777777557777557777777777777755557755777777777777777777777777555577777777777777777777755555577777777777777757777777777777777777775777777777777777777777
        7777777777777777777777755777777777775577777775777777777777777777777777777755777777777777777777777777557777777777775555555555777777777777777777777775555577777777
        7777777777777777777777777557777777777777777775577777777777777777777777777775577777777777777777777777755777777777775777777755557777777777777777777557777557777777
        7777777777777777777577777757777777777777777777557777777777777777777777777777557777777777777777777777775577777777777777777555755777777777777777775577777757777777
        777777777777775555557bb77777777777777777777777757777777777777777777777777777757777777777777777777777777557777777777777775577775777777777777777777755777757777777
        777777777775557777bbbbbbb7777777777777775557777557777777777777777777555577777557777777bbbbbb77777557777757777777777777775777775777777777777777777557777777777777
        777777777755777777bbbbbbbbb77777777775555777777757777777777777777755577777777757777777bbbbbbbb755757777777777777777777557777777777777777777777775577777777777777
        77777777755777777bbbbbddbbbbb7777555557777777777777777777777777555777777777777777777bbbbbbbbdbb77777777777777777777775777777777777777777777777755777777777777777
        77777777557777777bbbbbbbdbbbbbb77577777777777777777777777777775577777777777777777777bbbbbbbbddb77777777777777777777557777777777777777777777775577777777777777777
        77777775577777777bbbbbbbbbbbbbb75577777777777777777777777777755777777777777777777777bbbbbbbbbbbb7777777777777777777577777777777777777777777775777777777777777777
        7777777777777777bbbbbbbbbbbbbbbbb777777777777777777777777777557777777777777777777777bbbbbbbbbbbb7777777777777777755777777777777777777777777557777777777777777777
        7777777777777777bbbbbbbbbbbbbbbbb777777777777775577777777777577777777777777777777777bbbbbbbbbbbb7777777777777775577777777777777777777777775577777777777777777777
        7777777777777777bbbbbbbbbbbbbbbbb777777777777777555577777777577777777775555557777777bbbbbbbbbbbb7777777777777755777777777777777777777777755777777777777777777777
        7777777777777777bbbbbbbbbbbbbbbbb7777777777777777775777777755777777777777777755777777bbbbbbbbbbb7777777777777557777777777777777777777777557777777777777777777777
        7777777777777777bbbbbbbbbbbbbbbbb77777777777755777755777777577777777777777777757777755bbbbbbbbb77777777777775577777777777777777777777777577777777777777777777777
        777777777777777777bbbbbbbbbbbbb777777777777757557777577777557777777777777777775777775777777777777777777777775777777777777777777777777777777777777777777777777777
        77777777777777777bbbbbbbbbbbbb5777777777777557755777557777577755555555555777775777757777777777777777777777777777777777777777777777777777777777777777777777777777
        77777777777777775bbbbbbbbbbb775777777777777577775777755777777557777777777777775577777777777777777777777777777777777777777777777777777777777777777777777777777777
        777777777777777557bbbbbbbbb7775577777777775777777777775777777577777777777777777577777777777777777777777777777777777777777777777777777777777777777777777777777777
        777777777777775577bbbbbbbb77777577777777755777777777777777775577777777777777777577777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777557777bbbbb7777777577777777777777777777777777775777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777775777777777755777777577777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777557777777777775777777577777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777775577777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777775777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777755777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777757777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
        cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebddeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeebddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbdeeeeeeeeeeeeeeeeeeeeebbdeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeebbdbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedddddddddddeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeebbbbeeeee
        eeeeeeeeeeeeddddddddddeeeeeebbbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbdeeeeeeeeeeeeeeedddddddddddeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeebbbbeeeee
        eeeeeeeeddddeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbbeeeee
        eeeeeeddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddddddddddeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeedeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedddddddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedddeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedddeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddddddeeeeeeeeeeeeeeddeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddeeeeeeeeeeeeeeeeeeeddeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeedeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeddeeeeeeeeeeeeeeeeeeeeedeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeebbdeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbdeeeeeeeeeeeeeeeeeeeddeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeebbdeeeeee
        eeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbdeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeebbbeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeebbbeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        eeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeeee
        cccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccccc
        7777777777777777777755777777777777777777777777557777777777777777777777757777777777777777777777777775577777777777777777777777777757777777775555777777777777777777
        7777777777777777777775577777777777777777777777775577777777777777777777775577777777777777777777777777577777777777557777777777777757777755557777777777777777777777
        7777777777777777777777557777777777777777777777777557777777777777777777777557777777775555557777777777577777777555577777777777777755777557777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777799977777777777777777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777799977777777779997777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777799977777777779997777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777799977777777779997777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777779997777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777779997777777777555557777777777777777777777
        7777777777777777777777777777777777755577777777777777777777777777777777777777775555577999997777777777777555555577777777777777777555555777777777777777777777777777
        7777777777777777777777777777777555557755777777777777777777777777777777777755557777777999997777777775555588888888888888877775555577777777777777777777777777777777
        7777777777777777777777777777755577777777777777777777777777777777777777555577777777777999997777755555888888888888888888885557777777777777777777777777777777777777
        7777777777777777777777777775577777777777777777777777777777777777777555777777777777777777777755577788888888888999999998888877777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777778888888888888999999999888888777777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777788888888888888999999999988888887777779997555557777777777777777777
        7777777777777777777777777777777777777777777777777777777555555557777777777777777777777777777777888888888888888888889999988888887777779997777755555577777777777777
        7775555555777777777777777777777777777777777777777777777777777755777777777777777777775555777777888888888888888888888999988888887777799997777777777557777777777777
        777777777755577777777777777bbbbbbbb55777777777777777777777777777577777777777777777777777555578888888888888888888888899988888887777799997777777777755777777777777
        7777777777777557777777777bbbbbbbdbbb7555777777777777777777777777757777777777777777777777777788888888888777888888888888888888887777799997777777777775577777777777
        7777777777777755777777777bbbbbbdbddbbb75577777777777777777777777755777777777777777777777777888888888888777888888888888888888887777799977777777777777777777777777
        777777777777777557777777bbbbbbbbbbbdb777755777777777777777777777775577777777777777777777777888888888888777888888888888888888888777777775577777777777777777777777
        7777777777777777557777bbbbbbbbbbbbbbbb77775577777777777775777777777577777777777777755777777888888888888888888888888888888888888777777755755757777777777777777777
        777777777777777775777bbbbbbbbbbbbbbbbb75777777777777777555555777777777777777777777555577778888888888888877788888888888888888888777775577775577777777777777777777
        7777555557777777777bbbbbbbbbbbbbbbbbbb55557777777777775577777777777777777777777755777777788888888888888877788888888888888888888877755777777777777777777777777777
        777557777557777777777bbbbbbbbbbbbbbbb777757777777777755777777777777777777777777557777777788889999888888877788888888888877788888875577777777777777777777777777777
        77757777775577777777bbbbbbbbbbbbbbbbb777777777777777557777777777777777777777775577777777788899999888888888888888888888877788888875777777577777777777777777777777
        77757777557777777777b77bbbbbbbbbbbbbb777777777777775577777777777777777777777775799997777888999999888888888888888888888877788888877777777555555777777777777777777
        77777777755777777777777bbbbbbbbbbbbbb777777777777775777775577777777777777777755799995555888999998888888888888888888888888888888877777777777777555777777777777777
        777777777755777777777777bbbbbbbb7bbb5577777777777777777775755777777777777777757799997775888999988888888888888888888888888888888877777777777777775577777777777777
        7777777777755777777777777bbbbbbb77777757777777777777777777777557777777777777777777777777888999998888888888888888888888888888888877777777777777777557777777777777
        777777777777755777777777777bbbbb77777775577777777777777777777775577777777777777777777777888999999988888888888888888888888888888877999777777777777755777777777777
        7777777777777757777777777777777777777777577777777777777777777777757777777777777777777777888899999998888888887778888888888888888777999977777777777775577777777777
        7777777777777775577777777777777777777777755777777777777777777777775777777777777777777777888888999998888888887778888888888888888777999995577777777777777777777777
        7777777777777777557777777777777777777777777557777777777777777777777557777777777777777777888888899998888888887778888888888888887775999997777777777777777777777777
        7777777777777777755777777777777777777777777755777777777777777777777755777777777555555777788888889998888888888888888888887775577755799997777777777777777777777777
        7777777777777777775577777777777777777777777775577777777777777777777775777777755777777777778888888888888888888888888887777777575577777777777777777777777777777777
        7777777777777777777577777777777777777777777777557777777777777777777777557777757777777777777888888888888888888888888877777777575777777777777777777777777777777777
        7777777777777777777777777777777777777777777777757777777777777777777777757777757777777777777788888888888888888888888877777777757777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777775777757777755555555558888888888888888888888777777777757777777777777777777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777557777777777777778888888888888888887577777777777757777777777755577777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777577777777777777777588888888888888777757777777999557777777555557557777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777577777777777777777557777777777777777755777777999577777775577777755777777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777757777777777779999777777777999577777775777777775577777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777999777777777777777779999777777777777577777755777777777757777777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777999777777777777777779999777777777777577777757777777777775577777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777999777777777777777777999977777777777777777777777777777777557777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777999977777777777777777777777777777777757777777777777
        7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777999977777777777777777777777777777777755777777777777
        `)
    scroller.scrollBackgroundWithCamera(scroller.CameraScrollMode.BothDirections)
}
function setupPlayerMagic () {
    player_bolt_fire_rate = 750
    player_bolt_range = 75
    player_bolt_speed = 50
    player_bolt_damage = 1
    player_orb_count = 0
    player_orb_radius = 25
    player_orb_angular_velocity = 50
    player_orb_damage = 5
    magicCreateOrb()
}
function degreesToRadians (deg: number) {
    pi = 22 / 7
    return deg / 180 * pi
}
function setupPlayer () {
    player_speed = 50
    char = sprites.create(assets.image`char_static`, SpriteKind.Player)
    characterAnimations.loopFrames(
    char,
    assets.animation`char_standing`,
    500,
    characterAnimations.rule(Predicate.NotMoving)
    )
    characterAnimations.loopFrames(
    char,
    assets.animation`char_down`,
    200,
    characterAnimations.rule(Predicate.MovingDown)
    )
    characterAnimations.loopFrames(
    char,
    assets.animation`char_up`,
    200,
    characterAnimations.rule(Predicate.MovingUp)
    )
    characterAnimations.loopFrames(
    char,
    assets.animation`char_left`,
    200,
    characterAnimations.rule(Predicate.MovingLeft)
    )
    characterAnimations.loopFrames(
    char,
    assets.animation`char_right`,
    200,
    characterAnimations.rule(Predicate.MovingRight)
    )
    controller.moveSprite(char, player_speed, player_speed)
    scene.cameraFollowSprite(char)
}
function magicCreateOrb () {
    orb = sprites.create(assets.image`orb`, SpriteKind.orb)
    sprites.setDataNumber(orb, "id", player_orb_count)
    orb.setFlag(SpriteFlag.RelativeToCamera, true)
    player_orb_count += 1
}
function spawnEnemy () {
    spawn_distance = scene.screenWidth() * 0.8
    spawn_angle = degreesToRadians(randint(0, 359))
    mob = sprites.create(img`
        . . f f f . . . . . . . . f f f 
        . f f c c . . . . . . f c b b c 
        f f c c . . . . . . f c b b c . 
        f c f c . . . . . . f b c c c . 
        f f f c c . c c . f c b b c c . 
        f f c 3 c c 3 c c f b c b b c . 
        f f b 3 b c 3 b c f b c c b c . 
        . c b b b b b b c b b c c c . . 
        . c 1 b b b 1 b b c c c c . . . 
        c b b b b b b b b b c c . . . . 
        c b c b b b c b b b b f . . . . 
        f b 1 f f f 1 b b b b f c . . . 
        f b b b b b b b b b b f c c . . 
        . f b b b b b b b b c f . . . . 
        . . f b b b b b b c f . . . . . 
        . . . f f f f f f f . . . . . . 
        `, SpriteKind.Enemy)
    sprites.setDataNumber(mob, "life", 2)
    mob.setPosition(char.x + Math.cos(spawn_angle) * spawn_distance, char.y + (0 - Math.sin(spawn_angle) * spawn_distance))
    mob.z = -1
    characterAnimations.loopFrames(
    mob,
    [img`
        . . f f f . . . . . . . . f f f 
        . f f c c . . . . . . f c b b c 
        f f c c . . . . . . f c b b c . 
        f c f c . . . . . . f b c c c . 
        f f f c c . c c . f c b b c c . 
        f f c 3 c c 3 c c f b c b b c . 
        f f b 3 b c 3 b c f b c c b c . 
        . c b b b b b b c b b c c c . . 
        . c 1 b b b 1 b b c c c c . . . 
        c b b b b b b b b b c c . . . . 
        c b c b b b c b b b b f . . . . 
        f b 1 f f f 1 b b b b f c . . . 
        f b b b b b b b b b b f c c . . 
        . f b b b b b b b b c f . . . . 
        . . f b b b b b b c f . . . . . 
        . . . f f f f f f f . . . . . . 
        `,img`
        . . f f f . . . . . . . . . . . 
        f f f c c . . . . . . . . f f f 
        f f c c . . c c . . . f c b b c 
        f f c 3 c c 3 c c f f b b b c . 
        f f b 3 b c 3 b c f b b c c c . 
        . c b b b b b b c f b c b c c . 
        . c b b b b b b c b b c b b c . 
        c b 1 b b b 1 b b b c c c b c . 
        c b b b b b b b b c c c c c . . 
        f b c b b b c b b b b f c . . . 
        f b 1 f f f 1 b b b b f c c . . 
        . f b b b b b b b b c f . . . . 
        . . f b b b b b b c f . . . . . 
        . . . f f f f f f f . . . . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `,img`
        . . . . . . . . . . . . . . . . 
        . . c c . . c c . . . . . . . . 
        . . c 3 c c 3 c c c . . . . . . 
        . c b 3 b c 3 b c c c . . . . . 
        . c b b b b b b b b f f . . . . 
        c c b b b b b b b b f f . . . . 
        c b 1 b b b 1 b b c f f f . . . 
        c b b b b b b b b f f f f . . . 
        f b c b b b c b c c b b b . . . 
        f b 1 f f f 1 b f c c c c . . . 
        . f b b b b b b f b b c c . . . 
        c c f b b b b b c c b b c . . . 
        c c c f f f f f f c c b b c . . 
        . c c c . . . . . . c c c c c . 
        . . c c c . . . . . . . c c c c 
        . . . . . . . . . . . . . . . . 
        `,img`
        . f f f . . . . . . . . f f f . 
        f f c . . . . . . . f c b b c . 
        f c c . . . . . . f c b b c . . 
        c f . . . . . . . f b c c c . . 
        c f f . . . . . f f b b c c . . 
        f f f c c . c c f b c b b c . . 
        f f f c c c c c f b c c b c . . 
        . f c 3 c c 3 b c b c c c . . . 
        . c b 3 b c 3 b b c c c c . . . 
        c c b b b b b b b b c c . . . . 
        c b 1 b b b 1 b b b b f c . . . 
        f b b b b b b b b b b f c c . . 
        f b c b b b c b b b b f . . . . 
        . f 1 f f f 1 b b b c f . . . . 
        . . f b b b b b b c f . . . . . 
        . . . f f f f f f f . . . . . . 
        `],
    200,
    characterAnimations.rule(Predicate.MovingLeft)
    )
    characterAnimations.loopFrames(
    mob,
    [img`
        f f f . . . . . . . . f f f . . 
        c b b c f . . . . . . c c f f . 
        . c b b c f . . . . . . c c f f 
        . c c c b f . . . . . . c f c f 
        . c c b b c f . c c . c c f f f 
        . c b b c b f c c 3 c c 3 c f f 
        . c b c c b f c b 3 c b 3 b f f 
        . . c c c b b c b b b b b b c . 
        . . . c c c c b b 1 b b b 1 c . 
        . . . . c c b b b b b b b b b c 
        . . . . f b b b b c b b b c b c 
        . . . c f b b b b 1 f f f 1 b f 
        . . c c f b b b b b b b b b b f 
        . . . . f c b b b b b b b b f . 
        . . . . . f c b b b b b b f . . 
        . . . . . . f f f f f f f . . . 
        `,img`
        . . . . . . . . . . . f f f . . 
        f f f . . . . . . . . c c f f f 
        c b b c f . . . c c . . c c f f 
        . c b b b f f c c 3 c c 3 c f f 
        . c c c b b f c b 3 c b 3 b f f 
        . c c b c b f c b b b b b b c . 
        . c b b c b b c b b b b b b c . 
        . c b c c c b b b 1 b b b 1 b c 
        . . c c c c c b b b b b b b b c 
        . . . c f b b b b c b b b c b f 
        . . c c f b b b b 1 f f f 1 b f 
        . . . . f c b b b b b b b b f . 
        . . . . . f c b b b b b b f . . 
        . . . . . . f f f f f f f . . . 
        . . . . . . . . . . . . . . . . 
        . . . . . . . . . . . . . . . . 
        `,img`
        . . . . . . . . . . . . . . . . 
        . . . . . . . . c c . . c c . . 
        . . . . . . c c c 3 c c 3 c . . 
        . . . . . c c c b 3 c b 3 b c . 
        . . . . f f b b b b b b b b c . 
        . . . . f f b b b b b b b b c c 
        . . . f f f c b b 1 b b b 1 b c 
        . . . f f f f b b b b b b b b c 
        . . . b b b c c b c b b b c b f 
        . . . c c c c f b 1 f f f 1 b f 
        . . . c c b b f b b b b b b f . 
        . . . c b b c c b b b b b f c c 
        . . c b b c c f f f f f f c c c 
        . c c c c c . . . . . . c c c . 
        c c c c . . . . . . . c c c . . 
        . . . . . . . . . . . . . . . . 
        `,img`
        . f f f . . . . . . . . f f f . 
        . c b b c f . . . . . . . c f f 
        . . c b b c f . . . . . . c c f 
        . . c c c b f . . . . . . . f c 
        . . c c b b f f . . . . . f f c 
        . . c b b c b f c c . c c f f f 
        . . c b c c b f c c c c c f f f 
        . . . c c c b c b 3 c c 3 c f . 
        . . . c c c c b b 3 c b 3 b c . 
        . . . . c c b b b b b b b b c c 
        . . . c f b b b b 1 b b b 1 b c 
        . . c c f b b b b b b b b b b f 
        . . . . f b b b b c b b b c b f 
        . . . . f c b b b 1 f f f 1 f . 
        . . . . . f c b b b b b b f . . 
        . . . . . . f f f f f f f . . . 
        `],
    200,
    characterAnimations.rule(Predicate.Moving)
    )
    mob.follow(char, 10)
}
sprites.onOverlap(SpriteKind.Projectile, SpriteKind.Enemy, function (sprite, otherSprite) {
    if (sprites.readDataString(sprite, "type") == "bolt") {
        sprites.changeDataNumberBy(otherSprite, "life", 0 - sprites.readDataNumber(sprite, "damage"))
        if (sprites.readDataNumber(otherSprite, "life") <= 0) {
            otherSprite.destroy(effects.disintegrate, 100)
        }
        sprite.destroy(effects.fire, 100)
    }
})
let bolt: Sprite = null
let mob: Sprite = null
let spawn_angle = 0
let spawn_distance = 0
let orb: Sprite = null
let player_speed = 0
let pi = 0
let player_orb_damage = 0
let player_bolt_damage = 0
let player_bolt_speed = 0
let player_bolt_range = 0
let player_bolt_fire_rate = 0
let char: Sprite = null
let enemy_distance = 0
let enemy_closest_distance = 0
let enemy_closest: Sprite = null
let player_orb_radius = 0
let player_orb_count = 0
let player_orb_angle = 0
let player_orb_angular_velocity = 0
let player_orb_angle_index = 0
let enemies_max = 200
setupWorld()
setupPlayerMagic()
setupPlayer()
game.onUpdate(function () {
    magicUpdateOrbPositions()
    timer.throttle("bolt", player_bolt_fire_rate, function () {
        enemy_closest = closestEnemy()
        if (spriteDistance(char, enemy_closest) <= player_bolt_range) {
            bolt = sprites.createProjectileFromSprite(assets.image`bolt`, char, Math.sin(Math.atan2(enemy_closest.x - char.x, enemy_closest.y - char.y)) * player_bolt_speed, Math.cos(Math.atan2(enemy_closest.x - char.x, enemy_closest.y - char.y)) * player_bolt_speed)
            sprites.setDataString(bolt, "type", "bolt")
            sprites.setDataNumber(bolt, "damage", player_bolt_damage)
        }
    })
})
game.onUpdateInterval(500, function () {
    if (sprites.allOfKind(SpriteKind.Enemy).length < enemies_max) {
        spawnEnemy()
    }
})
